apiVersion: cloud.google.com/v1
kind: BackendConfig
metadata:
  name: sd-backendconfig-dreamworld   # change_other_model
spec:
  # sessionAffinity: # 用ip来固定负载均衡的pod
  #   affinityType: "CLIENT_IP"  
  sessionAffinity: # 用用GENERATED_COOKIE来固定负载均衡的pod
    affinityType: "GENERATED_COOKIE"  # HTTP_COOKIE
    affinityCookieTtlSec: 0
---
apiVersion: v1
kind: Service
metadata:
  name: sd-service-dreamworld   # change_other_model
  namespace: default
  annotations:
    cloud.google.com/backend-config: '{"ports": {"8080":"sd-backendconfig-dreamworld"}}'  # change_other_model
    # cloud.google.com/neg: '{"ingress": true}'
spec:
  ports:
  - port: 8080
    protocol: TCP
    targetPort: 7860
  selector:
    app: sd-dreamworld   # change_other_model--这里注意是deployment的label
  # type: NodePort
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: sd-ingress-dreamworld  # change_other_model
spec:
  defaultBackend:
    service:
      name: sd-service-dreamworld  # change_other_model
      port:
        number: 8080